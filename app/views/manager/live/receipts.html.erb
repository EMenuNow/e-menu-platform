
<h1>Receipts</h1>

<table class='table'>
  <thead>
    <tr>

      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Telephone</th>
      <th>Address</th>
      <th>Time</th>
      <th>Basket total</th>
      <th>Item</th>
      <th>Is ready</th>
    </tr>
  </thead>

  <tbody>
    <% @receipts.order(created_at: :desc).each do |receipt| %>
      <tr>
        <td><%= receipt.created_at.in_time_zone('Europe/London').strftime('%Y-%m-%d %H:%M') %></td>
        <td><%= receipt.name %></td>
        <td><%= receipt.delivery_or_collection %></td>
        <td><%= receipt.telephone %></td>
        <td><%= receipt.address %></td>
        <td><%= receipt.collection_time %></td>
        <td><%= number_to_currency(receipt.basket_total/100, unit: 'Â£') %></td>
        <%
        items = ""
        receipt.items['items'].each do |item|
        
        options = item['optionals']
        
        items << "<li>#{item['item']}<br> #{options.join('<br> ')}</li>"
        end
        %>
        <td><ul><%= items.html_safe %></ul></td>
        <td><%= receipt.is_ready %></td>

      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Receipt', new_receipt_path %>
